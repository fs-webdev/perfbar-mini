"use strict";function mergeRecursive(e,t){for(var n in t)try{t[n].constructor==Object?e[n]=mergeRecursive(e[n],t[n]):e[n]=t[n]}catch(i){e[n]=t[n]}return e}!function(){var e=".justice{position:fixed;bottom:0;left:0;right:0;background:black;padding:0 10px 10px 10px;box-sizing:border-box;font-size:12px;font-family:monospace;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;z-index:2147483647;-webkit-transition:400ms ease-in-out;transition:400ms ease-in-out;direction:ltr}@media (min-width: 1235px){.justice{padding-bottom:10px;}}.justice.closed{-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%)}.justice .justice-metric-wrap{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.justice .justice-metric{height:40px;display:inline-block;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:10px 10px 0 0}.justice .justice-metric.chart{width:300px}.justice .justice-title{text-transform:uppercase;padding:3px 0.5em 3px 3px;color:#dfdfdf}.justice .justice-text{color:#dfdfdf;font-weight:600}.justice .justice-text.pass{color:#419ba3}.justice .justice-text.warn{color:#d4ca3d}.justice .justice-text.fail{color:#ce452d}.justice .justice-toggle{width:20px;height:20px;cursor:pointer;background-color:black;position:absolute;right:0;top:-20px;opacity:0.5;border-top-left-radius:50%;-webkit-transition:400ms ease-in-out;transition:400ms ease-in-out}@media only screen and (min-device-pixel-ratio: 1.1){.justice .justice-toggle{width:40px;height:40px;top:-40px;}}.justice .justice-toggle:after{content:'';position:absolute;width:50%;height:50%;border-radius:100%;margin:5px;background-color:#dfdfdf;-webkit-transition:400ms ease-in-out;transition:400ms ease-in-out}@media only screen and (min-device-pixel-ratio: 1.1){.justice .justice-toggle:after{margin:10px;}}.justice.closed .justice-toggle{opacity:1}.justice.closed .justice-toggle:after{background-color:#419ba3}",t=document.createElement("style");if(document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet)t.styleSheet.disabled||(t.styleSheet.cssText=e);else try{t.innerHTML=e}catch(n){t.innerText=e}}();var Justice=function(){function e(e){var t={},e=e||{};for(var n in Q)t[n]=Q[n];for(var n in e)t[n]=e[n];return t}function t(e,t,n){for(var i in e.metrics)t[i]=n[i]}function n(){return M.loadEventStart-M.navigationStart}function i(){return M.domComplete-M.domLoading}function o(){return M.domInteractive-M.domLoading}function a(){var e=0;return window.chrome&&window.chrome.loadTimes?(e=1e3*window.chrome.loadTimes().firstPaintTime,e-=1e3*window.chrome.loadTimes().startLoadTime,e.toFixed(0)):"number"==typeof window.performance.timing.msFirstPaint?(e=window.performance.timing.msFirstPaint,e-=window.performance.timing.navigationStart,e.toFixed(0)):"¯\\_(ツ)_/¯"}function c(){return performance.getEntries?performance.getEntries().length:"¯\\_(ツ)_/¯"}function s(){return M.responseStart-M.connectEnd}function r(e){if(Y){var t=(e-Y)/1e3,n=1/t,i=n>60?60:Math.floor(n);_=i,D.push([i,i]),D.length>R&&D.shift(),Y=e}else Y=e}function l(e,t){var n="";return n=e>t?"fail":e>t*U.warnThreshold?"warn":"pass"}function d(e,t,n){var i=t.collector(),o=l(i,n);return['<div class="'+E+'-metric" id="'+t.id+'">','<span class="'+E+'-title">'+t.label+": </span>",'<span class="'+E+"-text "+o+'">'+i+t.unitLabel+"</span>","</div>"].join("")}function u(e){var t=[];for(var n in X){var i=d(n,X[n],U.metrics[n].budget);t.push(i)}return'<div id="'+E+'-text-metrics" class="'+E+'-metric-wrap">'+t.join("")+"</div>"}function p(){var e=U.showFPS?['<div class="'+E+'-metric chart">','<span class="'+E+'-title">FPS: </span>','<canvas id="'+E+'-fps" class="'+E+'-canvas" height="'+N+'" width="'+G+'"></canvas>',"</div>"].join(""):"";return e}function g(e,t){e.clearRect(0,0,t.width,t.height),b(e),f(e),m(e)}function f(e){var t=10;e.font="600 "+t+"px sans-serif",e.fillStyle=I,e.fillText(0,0,N),e.fillStyle=P,e.fillText(30,0,N/2+t/2),e.fillStyle=F,e.fillText(60,0,0+t)}function m(e){var t=e.createLinearGradient(0,N,0,0);t.addColorStop(0,I),t.addColorStop(.25,I),t.addColorStop(.5,P),t.addColorStop(1,F),e.strokeStyle=t,e.fillStyle=t}function b(e){for(var t=0;3>t;t++){var n=N/2*t+.5-(2===t?1:0);e.beginPath(),e.moveTo(.5+A,n),e.lineTo(G+.5,n),e.lineWidth=1,e.strokeStyle=L,e.stroke()}}function w(e){var t=null;return"spline"===e?t=v:"dots"===e&&(t=h),t}function h(e,t,n){g(e,t);for(var i=0;i<n.length;i++){var o=(60-n[i][1])*q;e.fillRect(n.length-i+A,o,1.5,1.5)}}function v(e,t,n){g(e,t),e.beginPath();var i=n.length>0?n[n.length]:0;e.moveTo(0,i);for(var o=0;o<n.length;o++){var a=0===o?0:o,c=(60-n[o][1])*q;e.lineTo(n.length-a+A,c)}e.lineWidth=1,e.stroke()}function y(){W=document.getElementById(E+"-fps"),K=W.getContext("2d")}function x(){var e=S();O=document.createElement("div"),O.id=E,O.classList.add(E),O.classList.add(e),document.body.appendChild(O),O=document.getElementById(E),O.innerHTML=['<div id="'+E+'-toggle" class="'+E+'-toggle"></div>',u(),p()].join(""),U.showFPS&&y(),T()}function j(){var e=u(X),t=document.getElementById(E+"-text-metrics");t.innerHTML=e}function T(){document.getElementById(E+"-toggle").onclick=function(){var e=document.getElementById(E);e.className.match(" closed")?(e.className=e.className.replace(" closed",""),k("open")):(e.className+=" closed",k("closed"))}}function k(e){window.localStorage&&window.localStorage.setItem(E+"-state",e)}function S(){return window.localStorage?window.localStorage.getItem(E+"-state")||"open":void 0}function C(e){H++,U.showFPS&&(r(e),z(K,W,D)),null===J?J=e:e-J>3e3&&(J=e,j()),window.requestAnimationFrame(C)}function B(n){M=window.performance.timing,U=e(n),t(U,X,V),x(),z=w(U.chartType),window.requestAnimationFrame(C)}var L="rgb(48, 48, 48)",I="rgb(206, 69, 45)",P="rgb(212, 202, 61)",F="rgb(65, 155, 163)",E="justice",G=300,N=40,q=N/60,A=20,R=G-A,J=0,H=0,M=null,O=null,z=null,_=0,D=[],Y=null,W=null,K=null,Q={metrics:{TTFB:{budget:200},domInteractive:{budget:250},domComplete:{budget:800},firstPaint:{budget:1e3},pageLoad:{budget:2e3},requests:{budget:6}},"interface":{position:"fixed",placement:"bottom"},warnThreshold:.8,chartType:"spline",showFPS:!0},U={},V={pageLoad:{id:E+"-load",label:"Load",unitLabel:"ms",collector:n},firstPaint:{id:E+"-paint",label:"Paint",unitLabel:"ms",collector:a},TTFB:{id:E+"-ttfb",label:"TTFB",unitLabel:"ms",collector:s},domComplete:{id:E+"-complete",label:"Complete",unitLabel:"ms",collector:i},domInteractive:{id:E+"-interactive",label:"Interactive",unitLabel:"ms",collector:o},requests:{id:E+"-requests",label:"Requests",unitLabel:"",collector:c}},X={};return{init:function(e){"performance"in window&&"timing"in window.performance?"complete"===document.readyState?B(e,"already loaded"):window.onload=function(){B(e)}:console.log("Justice: performance api not supported in this browser, initialization stopped.")}}}();window.fsJustice=function(){var e=!1;arguments.length>0&&(e=arguments[0]),e.gradeGoal=e.gradeGoal||"D",function(t,n){function i(e){var t=p?"https://edge.fscdn.org/assets/budgets/performance-budget-jsonp.min.json":"//edge.fscdn.org/assets/budgets/performance-budget-jsonp.min.json",n=document.createElement("script");n.src=t,document.body.appendChild(n),window.getData=function(t){o(t,function(t){e(t)})}}function o(e,n){g.budget=e,t.sessionStorage.setItem(f,JSON.stringify(e)),n&&n(e)}function a(e,t,n){e&&(g.scenario.pageType=e),t&&(g.scenario.connection=t),c({pageType:g.scenario.pageType,connection:g.scenario.connection},function(){n&&n()})}function c(e,n){e.pageType&&e.connection?(t.sessionStorage.setItem(m,JSON.stringify(e)),n&&n(e)):n&&n()}function s(){var e=h;arguments.length>0&&(e=mergeRecursive(h,arguments[0])),Justice.init(e),d()}function r(t){e.budgets&&(t=e.budgets);var n=e.budgets?g.currentBudget=e.budgets[g.scenario.connection]:g.currentBudget=t[g.scenario.pageType][g.scenario.connection],i={loadTime:{max:n.LoadTime[e.gradeGoal]},latency:{max:n.Latency[e.gradeGoal]},FirstPaint:{max:n.FirstPaint[e.gradeGoal]}};n.domInteractive&&(i.domInteractive=n.FirstPaint[e.gradeGoal]),h={metrics:{TTFB:{budget:i.latency.max},domInteractive:{budget:i.domInteractive?i.domInteractive.max:250},domComplete:{budget:i.domComplete?i.domComplete.max:100},firstPaint:{budget:i.FirstPaint.max||1e3},pageLoad:{budget:i.loadTime.max||2e3},requests:{budget:i.requests?i.requests.max:6}},warnThreshold:.8,showFPS:!1,chartType:"spline"},e.justice?s(e.justice):s()}function l(){t.location.reload()}function d(){t.requestAnimationFrame(function(){var e=document.getElementById("justice");return e?void u():d()})}function u(){function e(e,t){var n="";return"pageType"==e&&(n=g.scenario.pageType==t?"checked":""),"connection"==e&&(n=g.scenario.connection==t?"checked":""),n}var t=n.createElement("div");t.innerHTML='<div class="justice-switch"><abbr title="Compare page against different budgets per pagetype"><h5 class="perfBar-label">Pagetype:</h3><div class="switch"><input type="radio" class="switch-input" name="pagetype" value="landing" id="landing" onclick="perfBarAddons.handleSwitchClick(this)" '+e("pageType","landing")+'><label for="landing" class="switch-label switch-label-off">Landing</label><input type="radio" class="switch-input" name="pagetype" value="general" id="general" onclick="perfBarAddons.handleSwitchClick(this)" '+e("pageType","general")+'><label for="general" class="switch-label switch-label-on">General</label><span class="switch-selection"></span></div></abbr></div><div class="justice-switch"><abbr title="Compare page against different budgets per connection type"><h5 class="perfBar-label">Connection:</h3><div class="switch"><input type="radio" class="switch-input" name="connection" value="cable-desktop" id="cable-desktop" onclick="perfBarAddons.handleSwitchClick(this)" '+e("connection","cable-desktop")+'><label for="cable-desktop" class="switch-label switch-label-off">Cable</label><input type="radio" class="switch-input" name="connection" value="3G-mobile" id="3G-mobile" onclick="perfBarAddons.handleSwitchClick(this)" '+e("connection","3G-mobile")+'><label for="3G-mobile" class="switch-label switch-label-on">3G</label><span class="switch-selection"></span></div></abbr></div>',t.className="justice-scenarios closed",t.id="justice-scenarios";var i=n.createElement("div");i.className="justice-switch-toggle",i.innerHTML='<a href="#" id="justice-switch-toggle-button" onclick="perfBarAddons.handleSwitchToggleClick(); return false;" title="Set Default Scenario">+</a>';var o=n.getElementById("justice");n.querySelector(".justice-scenarios");o.appendChild(i,o.firstChild),o.appendChild(t,o.firstChild),g.handleSwitchToggleClick=function(){var e=n.getElementById("justice-scenarios");e.classList.toggle("closed")},g.handleSwitchClick=function(e){"pagetype"===e.name?a(e.value,null,function(){console.log("pagetype switch changed!"),l()}):"connection"===e.name?a(null,e.value,function(){console.log("connection switch changed!"),l()}):console.error("ERROR: Perfbar >> perfbarHandleClick : not a valid switch"),console.log("PerfBar: New performance budget scenario. Pagetype:",g.scenario.pageType,"Connection:",g.scenario.connection)}}var p=!0,g=window.perfBarAddons={scenario:{},budget:{},currentBudget:{}},f="fs-performance-budget",m=f+"-scenario",b=JSON.parse(t.sessionStorage.getItem(f)),w=JSON.parse(t.sessionStorage.getItem(m));console.time("getBudget"),w?a(w.pageType,w.connection):(e.pageType?g.scenario.pageType=e.pageType:g.scenario.pageType="landing",e.defaultConnection?g.scenario.connection=e.defaultConnection:g.scenario.connection="cable-desktop",a(g.scenario.pageType,g.scenario.connection)),b?(g.budget=b,r(g.budget)):i(function(e){g.budget=e,r(e)});var h}(window,document)};